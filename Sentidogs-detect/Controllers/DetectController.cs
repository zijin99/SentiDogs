using System;
using Microsoft.AspNetCore.Mvc;
using System.Threading.Tasks;
using System.Net.Http;
using System.Configuration;
using Newtonsoft.Json.Linq;
using System.Text.Json;

namespace Sentidogs_detect.Controllers
{
    [ApiController]
    [Route("[controller]")]
    public class DetectController : ControllerBase
    {
        private static readonly HttpClient client = new HttpClient();
        private const string API_KEY = "apiKey";
        private const string URL = "url";

        [HttpPost]
        public async Task<JsonDocument> Post(Document doc)
        {
            var apiKey = ConfigurationManager.AppSettings[API_KEY];
            var url = ConfigurationManager.AppSettings[URL] + "?q=" + doc.Text + "&engine=google&api_key=" + apiKey;

            var response = await client.GetAsync(url);

            var responseMsg = "";
            if (response.IsSuccessStatusCode)
            {
                responseMsg = await response.Content.ReadAsStringAsync();
            }

            //var responseMsg = "{     \"search_metadata\": {         \"id\": \"616e646247ccf11d7134083d\",         \"status\": \"Success\",         \"json_endpoint\": \"https://serpapi.com/searches/b1d76b8646fd0a82/616e646247ccf11d7134083d.json\",         \"created_at\": \"2021-10-19 06:23:30 UTC\",         \"processed_at\": \"2021-10-19 06:23:30 UTC\",         \"google_url\": \"https://www.google.com/search?q=mountain+view&oq=mountain+view&sourceid=chrome&ie=UTF-8\",         \"raw_html_file\": \"https://serpapi.com/searches/b1d76b8646fd0a82/616e646247ccf11d7134083d.html\",         \"total_time_taken\": 5.45     },     \"search_parameters\": {         \"engine\": \"google\",         \"q\": \"mountain view\",         \"google_domain\": \"google.com\",         \"device\": \"desktop\"     },     \"search_information\": {         \"organic_results_state\": \"Results for exact spelling\",         \"query_displayed\": \"mountain view\",         \"total_results\": 2080000000,         \"time_taken_displayed\": 0.75     },     \"local_map\": {         \"link\": \"https://www.google.com/search?q=mountain+view&npsic=0&rflfq=1&rldoc=1&rllag=32727085,-96908966,1609&tbm=lcl&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0QtgN6BAgaEAc\",         \"image\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/399309c2a23f12e10b8ec01bbaba2391.png\",         \"gps_coordinates\": {             \"latitude\": 32.727085,             \"longitude\": -96.908966,             \"altitude\": 1609         }     },     \"local_results\": {         \"more_locations_link\": \"https://www.google.com/search?tbs=lf:1,lf_ui:1&tbm=lcl&q=mountain+view&rflfq=1&num=10&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0QjGp6BAgaEFM\",         \"places\": [             {                 \"position\": 1,                 \"title\": \"The Villa at Mountain View\",                 \"place_id\": \"18362022280440117859\",                 \"lsig\": \"AB86z5X86EEnvp8jgZ_DaR4aPIIr\",                 \"place_id_search\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&lsig=AB86z5X86EEnvp8jgZ_DaR4aPIIr&ludocid=18362022280440117859&q=mountain+view&tbm=lcl\",                 \"reviews\": 44,                 \"type\": \"Rehabilitation center\",                 \"address\": \"Dallas, TX\",                 \"thumbnail\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/91d94346dbfbd251945b4055e0e5d9d2bab59e54cd9e8b7b2a07f3eed8b1e2050ed1ba25516b5063.jpeg\",                 \"gps_coordinates\": {                     \"latitude\": 32.71309,                     \"longitude\": -96.90837                 }             },             {                 \"position\": 2,                 \"title\": \"Dallas College Mountain View Campus\",                 \"place_id\": \"5566162349323564260\",                 \"lsig\": \"AB86z5W1wfCfMp0uyxOT2t-gQvUl\",                 \"place_id_search\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&lsig=AB86z5W1wfCfMp0uyxOT2t-gQvUl&ludocid=5566162349323564260&q=mountain+view&tbm=lcl\",                 \"reviews\": 187,                 \"type\": \"Community college\",                 \"address\": \"Dallas, TX\",                 \"thumbnail\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/91d94346dbfbd251945b4055e0e5d9d2933a0368d83797529566d76e2dd86dc65f3d5de9fd664097.jpeg\",                 \"gps_coordinates\": {                     \"latitude\": 32.726738,                     \"longitude\": -96.904526                 }             },             {                 \"position\": 3,                 \"title\": \"Mountain View Apartments\",                 \"place_id\": \"4409414689233857280\",                 \"lsig\": \"AB86z5UoQLQ7UhqhUoCoeRb8Zz04\",                 \"place_id_search\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&lsig=AB86z5UoQLQ7UhqhUoCoeRb8Zz04&ludocid=4409414689233857280&q=mountain+view&tbm=lcl\",                 \"reviews\": 94,                 \"type\": \"Apartment rental agency\",                 \"address\": \"Dallas, TX\",                 \"description\": \"I currently live in Mountain View.\",                 \"thumbnail\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/91d94346dbfbd251945b4055e0e5d9d29c737eac4d0bfa8e05b8323567adcf1ed06c16094ba03496.jpeg\",                 \"gps_coordinates\": {                     \"latitude\": 32.74108,                     \"longitude\": -96.91341                 }             }         ]     },     \"inline_images\": [         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAg7EAE#imgrc=k1UPeDSShQostM\",             \"thumbnail\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/fcb1efbe04fd33f44244b62a067d7ef900082f99a1c51d00d70b96aac60858b0.png\"         },         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAg9EAE#imgrc=3iniqEfjFFBuMM\",             \"thumbnail\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/fcb1efbe04fd33f45f3ed674cc2a689b16fa319337a06d3e665b9685a276a8b8.jpeg\"         },         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAgzEAE#imgrc=okE8-q8FZy9XkM\",             \"thumbnail\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/fcb1efbe04fd33f4fe7cc0e80fd474befcc74e28e35194e37f9610d08d1ef57f.jpeg\"         },         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAg0EAE#imgrc=gpFbDOwiGf0tQM\",             \"thumbnail\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/fcb1efbe04fd33f467a1dc0f8a79077fe220df1ca79bf6a454128bf1a8c759d8.jpeg\"         },         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAg2EAE#imgrc=2V8LPL0ok0r9AM\",             \"thumbnail\": \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQjSnuxHyui0N5FWl3p_Mmg9QYYugRBmPh8pwQkvDWP&s\"         },         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAg3EAE#imgrc=YUh6f8poaa-58M\",             \"thumbnail\": \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQegB9EmeCbg7Yfka_pEkDg5779gQbPqr72V823QkyIEw&s\"         },         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAg4EAE#imgrc=ccYfV5HmsUFPNM\",             \"thumbnail\": \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSL0nhwf1hM80EB7sD9SQxoCOjXSNGgvxl8Xu6-nhYP4Q&s\"         },         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAg5EAE#imgrc=f6EiH51dltNXMM\",             \"thumbnail\": \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR3n0NHEPoHooxzfxB9vKUx-J_sUnjXaVrf_rjgHULnVw&s\"         },         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAg8EAE#imgrc=YGI1spH458Yi7M\",             \"thumbnail\": \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTL3zpXgkENw6rVrs1_4vtx48oXdEtTfmViO16IWBw-EQ&s\"         },         {             \"link\": \"/search?q=mountain+view&tbm=isch&source=iu&ictx=1&fir=k1UPeDSShQostM%252CSrZAkrJAjFc1MM%252C_%253B3iniqEfjFFBuMM%252CSM9boeIelohm-M%252C_%253BokE8-q8FZy9XkM%252C6hOzWCIeDq10-M%252C_%253BgpFbDOwiGf0tQM%252CE6ahg_GOfls88M%252C_%253B2V8LPL0ok0r9AM%252CRpzYi3Qw4VQKcM%252C_%253BYUh6f8poaa-58M%252Cq0L6aOQ9RYDxlM%252C_%253BccYfV5HmsUFPNM%252C47qH09pyjIgzkM%252C_%253Bf6EiH51dltNXMM%252CzvtXbn1vaWaMnM%252C_%253BYGI1spH458Yi7M%252Chqa-V_SWIdfssM%252C_%253BR1hYUDCXq16FwM%252CRpzYi3Qw4VQKcM%252C_&vet=1&usg=AI4_-kS6JS-GSGfJaD9NsqmmrpL7jmotSg&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q9QF6BAgyEAE#imgrc=R1hYUDCXq16FwM\",             \"thumbnail\": \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSTqeERouqeYpdbILjRbVw2A0jzeFhz_ubU5hvRsFfLmQ&s\"         }     ],     \"related_questions\": [         {             \"question\": \"How much does Mountain View College Cost?\",             \"snippet\": \"Dallas College Mountain View Campus/Undergraduate tuition and fees\",             \"title\": \"In-state tuition 3,330 USD, Out-of-state tuition 5,220 USD (2019 – 20)\",             \"link\": \"https://www.google.com/search?q=How+much+does+Mountain+View+College+Cost%3F&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Qzmd6BAgWEAU\"         },         {             \"question\": \"What does Mountain View College offer?\",             \"snippet\": \"Popular programs include: Liberal Arts and Sciences, General Studies and Humanities, Business, Management, Marketing, and Related Support Services, and Education.\",             \"title\": \"Mountain View College in Dallas, TX | US News Education\",             \"link\": \"https://www.usnews.com/education/community-colleges/mountain-view-college-CC05660\",             \"displayed_link\": \"https://www.usnews.com › education › community-colleges\"         },         {             \"question\": \"Is Mountain View High School?\",             \"title\": \"Mountain View High School (MVHS) is located at 3535 Truman Avenue, Mountain View, California, 94040. It is one of two Mountain View-Los Altos Union High School District public high schools....Mountain View High School (Mountain View, California)\",             \"link\": \"https://en.wikipedia.org/wiki/Mountain_View_High_School_(Mountain_View,_California)\",             \"displayed_link\": \"https://en.wikipedia.org › wiki › Mountain_View_High_S...\"         },         {             \"question\": \"Where is Mountain View area?\",             \"title\": \"Mountain View is a city in Santa Clara County, California, United States....\",             \"link\": \"https://en.wikipedia.org/wiki/Mountain_View,_California\",             \"displayed_link\": \"https://en.wikipedia.org › wiki › Mountain_View,_Calif...\"         }     ],     \"organic_results\": [         {             \"position\": 1,             \"title\": \"Mountain View Campus - Dallas College\",             \"link\": \"https://www.dallascollege.edu/about/mvc/pages/default.aspx\",             \"displayed_link\": \"https://www.dallascollege.edu › about › mvc › pages\",             \"snippet\": \"Dallas College Mountain View Campus has served Oak Cliff and southwestern Dallas County since 1970. Our campus sits on both sides of a limestone canyon, ...\",             \"about_this_result\": {                 \"source\": {                     \"description\": \"Dallas College consists of seven campuses in Dallas County, Texas. It is headquartered at 1601 S. Lamar St. in Dallas. Dallas College serves more than 70,000 students annually in academic, continuing education and adult education programs.\",                     \"source_info_link\": \"https://en.wikipedia.org/wiki/Dallas_College\",                     \"security\": \"secure\",                     \"icon\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/a62f0dd95b48f09690267a4fa3070c0f84da80361b91b83334b09227fa4055cf030db3312258b217696e427db4a85d68.png\"                 },                 \"keywords\": [                     \"mountain\",                     \"view\"                 ],                 \"languages\": [                     \"English\"                 ]             },             \"cached_page_link\": \"https://webcache.googleusercontent.com/search?q=cache:6hOzWCIeDq0J:https://www.dallascollege.edu/about/mvc/pages/default.aspx+&cd=4&hl=en&ct=clnk&gl=us\"         },         {             \"position\": 2,             \"title\": \"City of Mountain View - Home\",             \"link\": \"https://www.mountainview.gov/\",             \"displayed_link\": \"https://www.mountainview.gov\",             \"snippet\": \"Popular Links. Council Meetings and Agendas · COVID-19 Community Resources · Race, Equity and Inclusion · Rent Stabilization · Strategic Planning and ...\",             \"about_this_result\": {                 \"source\": {                     \"description\": \"mountainview.gov was first indexed by Google more than 10 years ago\",                     \"security\": \"secure\",                     \"icon\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/a62f0dd95b48f09690267a4fa3070c0f1970faab483bbf5be1d9482f0668804d9b97e11ce33564b09434d1bf2745fc46.png\"                 },                 \"keywords\": [                     \"mountain\",                     \"view\"                 ],                 \"languages\": [                     \"English\"                 ],                 \"regions\": [                     \"the United States\"                 ]             },             \"cached_page_link\": \"https://webcache.googleusercontent.com/search?q=cache:a8OH8AsIRbkJ:https://www.mountainview.gov/+&cd=13&hl=en&ct=clnk&gl=us\"         },         {             \"position\": 3,             \"title\": \"Mountain View, California - Wikipedia\",             \"link\": \"https://en.wikipedia.org/wiki/Mountain_View,_California\",             \"displayed_link\": \"https://en.wikipedia.org › wiki › Mountain_View,_Calif...\",             \"snippet\": \"Mountain View is a city in Santa Clara County, California, United States. Named for its views of the Santa Cruz Mountains, It has a population of 82,739.\",             \"sitelinks\": {                 \"inline\": [                     {                         \"title\": \"History\",                         \"link\": \"https://en.wikipedia.org/wiki/Mountain_View,_California#History\"                     },                     {                         \"title\": \"Geography\",                         \"link\": \"https://en.wikipedia.org/wiki/Mountain_View,_California#Geography\"                     },                     {                         \"title\": \"Economy\",                         \"link\": \"https://en.wikipedia.org/wiki/Mountain_View,_California#Economy\"                     },                     {                         \"title\": \"Demographics\",                         \"link\": \"https://en.wikipedia.org/wiki/Mountain_View,_California#Demographics\"                     }                 ]             },             \"rich_snippet\": {                 \"bottom\": {                     \"extensions\": [                         \"County: Santa Clara\",                         \"Elevation: 105 ft (32 m)\",                         \"Area code: 650\",                         \"ZIP codes: 94035, 94039–94043\"                     ],                     \"detected_extensions\": {                         \"price\": 105,                         \"currency\": \"Elevation ft ( m)\",                         \"area_code\": 650,                         \"z_ip_codes\": 94035                     }                 }             },             \"about_this_result\": {                 \"source\": {                     \"description\": \"Wikipedia is a free content, multilingual online encyclopedia written and maintained by a community of volunteers through a model of open collaboration, using a wiki-based editing system. Individual contributors, also called editors, are known as Wikipedians.\",                     \"source_info_link\": \"https://en.wikipedia.org/wiki/Wikipedia\",                     \"security\": \"secure\",                     \"icon\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/a62f0dd95b48f09690267a4fa3070c0f6abe3040d9141602c66dfd12fd2890276253d446a5c8569c6820bd2009a188ed.png\"                 },                 \"keywords\": [                     \"mountain\",                     \"view\"                 ],                 \"languages\": [                     \"English\"                 ],                 \"regions\": [                     \"the United States\"                 ]             },             \"cached_page_link\": \"https://webcache.googleusercontent.com/search?q=cache:q-609v_GwOQJ:https://en.wikipedia.org/wiki/Mountain_View,_California+&cd=14&hl=en&ct=clnk&gl=us\",             \"related_pages_link\": \"https://www.google.com/search?q=related:https://en.wikipedia.org/wiki/Mountain_View,_California+mountain+view\"         },         {             \"position\": 4,             \"title\": \"Mountain View High School - Mesa Public Schools\",             \"link\": \"http://www.mpsaz.org/mtnview\",             \"displayed_link\": \"http://www.mpsaz.org › mtnview\",             \"date\": \"8 days ago\",             \"snippet\": \"Mountain View High School Campus of Champions · Mike Oliver Principal · Office 480-472-6900 · Registrar 480-472-6948 · Attendance · Other.\",             \"about_this_result\": {                 \"source\": {                     \"description\": \"Mesa Public Schools is the largest public school district in the state of Arizona. Its approximately 64,000 students enjoy opportunities such as Montessori, International Baccalaureate, dual-language immersion, honors and Advanced Placement courses and Franklin traditional schools.\",                     \"source_info_link\": \"https://en.wikipedia.org/wiki/Mesa_Public_Schools\",                     \"security\": \"not secure\",                     \"icon\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/a62f0dd95b48f09690267a4fa3070c0ffabe193df6a7e41c921ae06e1dad025fb743fb268bbffa3ba3692533c095dc98.png\"                 },                 \"keywords\": [                     \"mountain\",                     \"view\"                 ],                 \"related_keywords\": [                     \"views\"                 ],                 \"languages\": [                     \"English\"                 ],                 \"regions\": [                     \"the United States\"                 ]             },             \"cached_page_link\": \"http://webcache.googleusercontent.com/search?q=cache:IbtHNs4mjDAJ:www.mpsaz.org/mtnview+&cd=25&hl=en&ct=clnk&gl=us\",             \"related_pages_link\": \"https://www.google.com/search?q=related:www.mpsaz.org/mtnview+mountain+view\"         },         {             \"position\": 5,             \"title\": \"Mountain View High School - Home\",             \"link\": \"https://mvhs.mvla.net/\",             \"displayed_link\": \"https://mvhs.mvla.net\",             \"snippet\": \"We at MVHS value an equitable and collaborative learning environment in which students and staff respect the diversity of our society. · Points of Pride.\",             \"about_this_result\": {                 \"source\": {                     \"description\": \"Mountain View High School is located at 3535 Truman Avenue, Mountain View, California, 94040. It is one of two Mountain View-Los Altos Union High School District public high schools.\",                     \"source_info_link\": \"https://en.wikipedia.org/wiki/Mountain_View_High_School_(Mountain_View,_California)\",                     \"security\": \"secure\",                     \"icon\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/a62f0dd95b48f09690267a4fa3070c0f9e036077ea82495be2cb5d292fd0b2f41dba9739a09805d8d144588e71046187.png\"                 },                 \"keywords\": [                     \"mountain\",                     \"view\"                 ],                 \"languages\": [                     \"English\"                 ],                 \"regions\": [                     \"the United States\"                 ]             },             \"cached_page_link\": \"https://webcache.googleusercontent.com/search?q=cache:SlWDArR-YWgJ:https://mvhs.mvla.net/+&cd=26&hl=en&ct=clnk&gl=us\"         },         {             \"position\": 6,             \"title\": \"Mountain View School District: Home\",             \"link\": \"http://mountainview.ss11.sharpschool.com/\",             \"displayed_link\": \"http://mountainview.ss11.sharpschool.com\",             \"snippet\": \"The Mountain View School District is a K-8 district located in the heart of the San Gabriel Valley and proudly serves approximately 5,500 students at eight ...\",             \"about_this_result\": {                 \"source\": {                     \"description\": \"Mountain View School District is a public school district based in Los Angeles County, California, United States that operates ten elementary schools, two middle schools, and two learning centers.\",                     \"source_info_link\": \"https://en.wikipedia.org/wiki/Mountain_View_School_District_(Los_Angeles_County,_California)\",                     \"security\": \"not secure\",                     \"icon\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/a62f0dd95b48f09690267a4fa3070c0f9070683d1570d1092228ac6e6391d51ae25bc657b8bda220355829e524119cfd.png\"                 },                 \"keywords\": [                     \"mountain\",                     \"view\"                 ],                 \"languages\": [                     \"English\"                 ],                 \"regions\": [                     \"the United States\"                 ]             },             \"cached_page_link\": \"http://webcache.googleusercontent.com/search?q=cache:sbQcRaDjgJgJ:mountainview.ss11.sharpschool.com/+&cd=27&hl=en&ct=clnk&gl=us\"         },         {             \"position\": 7,             \"title\": \"Mountain View Grand Resort | White Mountain NH Hotels\",             \"link\": \"https://www.mountainviewgrand.com/\",             \"displayed_link\": \"https://www.mountainviewgrand.com\",             \"snippet\": \"Let the Mountain View Grand Resort become your home away from home when you're looking for White Mountain resorts.\",             \"about_this_result\": {                 \"source\": {                     \"description\": \"The Mountain View Grand Resort & Spa – formerly called the Mountain View House – is a historic grand hotel at 101 Mountain View Road in Whitefield, New Hampshire, United States, with claims to dating back to 1865.\nIt is listed on the National Register of Historic Places.\",                     \"source_info_link\": \"https://en.wikipedia.org/wiki/Mountain_View_House\",                     \"security\": \"secure\",                     \"icon\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/a62f0dd95b48f09690267a4fa3070c0f0e0d36fcdeb46c3581bc8022d08f3b08e7b0230b2b18eef45d65a7ba8c9f9b6a.png\"                 },                 \"keywords\": [                     \"mountain\",                     \"view\"                 ],                 \"languages\": [                     \"English\"                 ],                 \"regions\": [                     \"the United States\"                 ]             },             \"cached_page_link\": \"https://webcache.googleusercontent.com/search?q=cache:QEe0CI2IBE0J:https://www.mountainviewgrand.com/+&cd=28&hl=en&ct=clnk&gl=us\"         },         {             \"position\": 8,             \"title\": \"Chamber of Commerce | Mountain View Area Chamber of ...\",             \"link\": \"https://www.yourplaceinthemountains.com/\",             \"displayed_link\": \"https://www.yourplaceinthemountains.com\",             \"snippet\": \"Mountain View is the largest city in and the county seat of Stone County, Arkansas, United States. Located in the Ozarks, the city has a rich tradition of ...\",             \"about_this_result\": {                 \"source\": {                     \"description\": \"yourplaceinthemountains.com was first indexed by Google more than 10 years ago\",                     \"security\": \"secure\",                     \"icon\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/a62f0dd95b48f09690267a4fa3070c0f0c638bace38691dd4b9e38e06d1bdf951d2b16249468f412d5e0eef5915a61d4.png\"                 },                 \"keywords\": [                     \"mountain\",                     \"view\"                 ],                 \"languages\": [                     \"English\"                 ],                 \"regions\": [                     \"the United States\"                 ]             },             \"cached_page_link\": \"https://webcache.googleusercontent.com/search?q=cache:S2W4Jlk9Z-oJ:https://www.yourplaceinthemountains.com/+&cd=29&hl=en&ct=clnk&gl=us\",             \"related_pages_link\": \"https://www.google.com/search?q=related:https://www.yourplaceinthemountains.com/+mountain+view\"         },         {             \"position\": 9,             \"title\": \"Mountain View Whisman School District: Home\",             \"link\": \"https://www.mvwsd.org/\",             \"displayed_link\": \"https://www.mvwsd.org\",             \"snippet\": \"Mountain View Whisman School District (MVWSD) serves students in grades transitional kindergarten to eighth grade (K-8) in Mountain View, California.\",             \"about_this_result\": {                 \"source\": {                     \"description\": \"Mountain View Whisman School District is a public school district located in Mountain View, California. It consists of nine primary schools and two middle schools. High schoolers living in Mountain View are served by the Mountain View–Los Altos Union High School District.\",                     \"source_info_link\": \"https://en.wikipedia.org/wiki/Mountain_View_Whisman_School_District\",                     \"security\": \"secure\",                     \"icon\": \"https://serpapi.com/searches/616e646247ccf11d7134083d/images/a62f0dd95b48f09690267a4fa3070c0fe0fd49a53ca2e14bf0ec42427f08a9670bdfa3a5c504c8c514d06a3a1550545a.png\"                 },                 \"keywords\": [                     \"mountain\",                     \"view\"                 ],                 \"languages\": [                     \"English\"                 ],                 \"regions\": [                     \"the United States\"                 ]             },             \"cached_page_link\": \"https://webcache.googleusercontent.com/search?q=cache:hsghycetMAIJ:https://www.mvwsd.org/+&cd=30&hl=en&ct=clnk&gl=us\",             \"related_pages_link\": \"https://www.google.com/search?q=related:https://www.mvwsd.org/+mountain+view\"         }     ],     \"related_searches\": [         {             \"query\": \"mountain view, arkansas\",             \"link\": \"https://www.google.com/search?q=Mountain+View,+Arkansas&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q1QJ6BAgxEAE\"         },         {             \"query\": \"mountain view college\",             \"link\": \"https://www.google.com/search?q=Mountain+View+College&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q1QJ6BAgwEAE\"         },         {             \"query\": \"mountain view hospital\",             \"link\": \"https://www.google.com/search?q=Mountain+View+Hospital&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q1QJ6BAguEAE\"         },         {             \"query\": \"mountain view high school\",             \"link\": \"https://www.google.com/search?q=Mountain+View+High+School&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q1QJ6BAgrEAE\"         },         {             \"query\": \"mountain view apartments\",             \"link\": \"https://www.google.com/search?q=Mountain+View+Apartments&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q1QJ6BAgnEAE\"         },         {             \"query\": \"mountain view elementary\",             \"link\": \"https://www.google.com/search?q=Mountain+View+Elementary&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q1QJ6BAgjEAE\"         },         {             \"query\": \"mountain view golf\",             \"link\": \"https://www.google.com/search?q=Mountain+View+Golf&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q1QJ6BAghEAE\"         },         {             \"query\": \"mountain view, california\",             \"link\": \"https://www.google.com/search?q=Mountain+View,+California&sa=X&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q1QJ6BAgfEAE\"         }     ],     \"pagination\": {         \"current\": 1,         \"next\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=10&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8NMDegQIARBJ\",         \"other_pages\": {             \"2\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=10&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8tMDegQIARA3\",             \"3\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=20&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8tMDegQIARA5\",             \"4\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=30&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8tMDegQIARA7\",             \"5\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=40&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8tMDegQIARA9\",             \"6\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=50&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8tMDegQIARA_\",             \"7\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=60&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8tMDegQIARBB\",             \"8\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=70&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8tMDegQIARBD\",             \"9\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=80&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8tMDegQIARBF\",             \"10\": \"https://www.google.com/search?q=mountain+view&ei=Z2RuYdeCDrmkqtsPxoCi6A8&start=90&sa=N&ved=2ahUKEwiX0qCc69XzAhU5kmoFHUaACP0Q8tMDegQIARBH\"         }     },     \"serpapi_pagination\": {         \"current\": 1,         \"next_link\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=10\",         \"next\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=10\",         \"other_pages\": {             \"2\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=10\",             \"3\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=20\",             \"4\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=30\",             \"5\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=40\",             \"6\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=50\",             \"7\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=60\",             \"8\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=70\",             \"9\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=80\",             \"10\": \"https://serpapi.com/search.json?device=desktop&engine=google&google_domain=google.com&q=mountain+view&start=90\"         }     } }";
            var json_resp = JObject.Parse(responseMsg);
            var isResturarant = isRestaurant(json_resp);
            var local_map = getLocalMap(json_resp);

            var result = "{\"resp\":{\"isrestaurant\":\"" + isResturarant + "\", \"local_map\":\"" + local_map + "\"}}";

            return JsonDocument.Parse(result);
        }

        private string getLocalMap(JObject json_resp)
        {
            JToken local_map = "";
            JToken knowledge_graph = "";
            JToken link = "";
            if (json_resp.TryGetValue("local_map", out local_map))
            {
                Console.WriteLine(local_map);
                link = local_map.SelectToken("link");
                if (link != null)
                    Console.WriteLine(link);
            }

            if (json_resp.TryGetValue("knowledge_graph", out knowledge_graph))
            {
                Console.WriteLine(knowledge_graph);
                local_map = knowledge_graph.SelectToken("local_map");
                if (local_map != null)
                {
                    link = local_map.SelectToken("link");
                    if (link != null)
                        Console.WriteLine(link);
                }
            }
            return link.ToString();
        }


        [HttpGet]
        public Document Get()
        {
            Document doc = new Document
            {
                Text = "This is a GET call. Please make a POST call to test the restaurant detection API. :)"
            };

            return doc;
        }



        private bool isRestaurant(JObject json_resp)
        {
            JToken knowledge_graph = "";
            if (json_resp.TryGetValue("knowledge_graph", out knowledge_graph))
            {
                Console.WriteLine(knowledge_graph);
                var type = knowledge_graph.SelectToken("type");
                if (type != null && (type.ToString().ToLower().Contains("restaurant") || type.ToString().ToLower().Contains("cafe")))
                {
                    Console.WriteLine(type);
                    return true;
                }
            }

            return false;
        }
    }
}
